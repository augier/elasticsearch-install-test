box: wunki/elasticsearch
services:
  - wunki/elasticsearch@0.0.2
build:
  steps:

    # - augier/elasticsearch-install:
    #     version: 1.3.1

    - script:
        name: blah
        code: |
            sudo wget -O /tmp/elasticsearch-$WERCKER_ELASTICSEARCH_INSTALL_VERSION.deb https://download.elasticsearch.org/elasticsearch/elasticsearch/elasticsearch-$WERCKER_ELASTICSEARCH_INSTALL_VERSION.deb
            sudo dpkg -i /tmp/elasticsearch-$WERCKER_ELASTICSEARCH_INSTALL_VERSION.deb
            sudo curl -I 'http://127.0.0.1:9200'
            sudo sed -i 's/# http.enabled: false/http.enabled: true/g' /etc/elasticsearch/elasticsearch.yml
            sudo sed -i 's/# network.host: 192.168.0.1/network.host: $$HOST$$/g' /etc/elasticsearch/elasticsearch.yml
            sudo service elasticsearch restart

    - script:
        name: finalise
        code: |
            sudo netstat -tulpn
            sudo ifconfig
            sudo vi /etc/hosts
            sudo curl -I 'http://127.0.0.1:9200'